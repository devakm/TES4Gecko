package TES4Gecko;

import java.io.*;

import java.util.ArrayList;
import java.util.List;
import java.util.ListIterator;

import java.awt.*;
import java.awt.event.*;
import javax.swing.*;
import javax.swing.event.*;
import javax.swing.tree.*;

/**
 * Dialog to display the data for a subrecord
 */
public class DisplaySubrecordDialog extends JDialog implements ActionListener {

    /**
     * Create the display dialog
     *
     * @param       parent          Parent window for the dialog
     * @param       subrecord       The subrecord to display
     */
    public DisplaySubrecordDialog(JDialog parent, PluginSubrecord subrecord) {
        super(parent, "Subrecord Data: " + subrecord.getSubrecordType(), true);
        super.setMaximumSize(parent.getSize());
        setDefaultCloseOperation(WindowConstants.DISPOSE_ON_CLOSE);
        
        //
        // Set up the content pane
        //
        JPanel contentPane = new JPanel();
        contentPane.setLayout(new BoxLayout(contentPane, BoxLayout.Y_AXIS));
        contentPane.setOpaque(true);
        contentPane.setBackground(Main.backgroundColor);
        contentPane.setBorder(BorderFactory.createEmptyBorder(30, 30, 30, 30));
        contentPane.setMaximumSize(parent.getSize());

        // Set the label showing how he data is displayed.
        JLabel displayTypeLabel = new JLabel("<html><b>Subrecord data displayed as " +
        		subrecord.getDisplayDataypeLabel() + "</b></html>");
        displayTypeLabel.setAlignmentX(LEFT_ALIGNMENT);
        JPanel displayTypePane = new JPanel();
        displayTypePane.setBackground(Main.backgroundColor);
        displayTypePane.add(displayTypeLabel);
        displayTypePane.setMaximumSize(parent.getSize());

        //
        // Create the text area containing the record data
        //
        JTextArea textArea = new JTextArea(subrecord.getDisplayData());
        textArea.setMaximumSize(parent.getSize());
        JScrollPane scrollPane = new JScrollPane(textArea);
        scrollPane.setVerticalScrollBarPolicy(ScrollPaneConstants.VERTICAL_SCROLLBAR_AS_NEEDED);
        
        //
        // Create the buttons
        //
        JPanel buttonPane = new JPanel();
        buttonPane.setBackground(Main.backgroundColor);

        JButton button = new JButton("Done");
        button.setActionCommand("done");
        button.setHorizontalAlignment(SwingConstants.CENTER);
        button.addActionListener(this);
        buttonPane.add(button);
        buttonPane.setMaximumSize(parent.getSize());


        contentPane.add(displayTypePane);
        contentPane.add(scrollPane);
        contentPane.add(Box.createVerticalStrut(15));
        contentPane.add(buttonPane);
        contentPane.setMaximumSize(parent.getSize());
        setContentPane(contentPane);  

    }

    /**
     * Show the dialog
     *
     * @param       parent          Parent window for the dialog
     * @param       subrecord       The subrecord to display
     */
    public static void showDialog(JDialog parent, PluginSubrecord subrecord) {
        DisplaySubrecordDialog dialog = new DisplaySubrecordDialog(parent, subrecord);
        dialog.setMaximumSize(parent.getSize());
        Dimension testDim3 = dialog.getSize();
        dialog.pack();
        Dimension testDim4 = dialog.getSize();
        dialog.setLocationRelativeTo(parent);
        dialog.setVisible(true);
    }
    
    /**
     * Action performed (ActionListener interface)
     *
     * @param       ae              Action event
     */
    public void actionPerformed(ActionEvent ae) {
        try {
            String action = ae.getActionCommand();
            if (action.equals("done")) {
                setVisible(false);
                dispose();                
            }            
        } catch (Throwable exc) {
            Main.logException("Exception while processing action event", exc);
        }       
    }
}
